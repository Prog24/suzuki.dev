{"pageProps":{"frontmatter":{"title":"Let’s EncryptでSSL設定","date":"2018-02-18T10:00:00.000Z","template":"post","draft":false,"slug":"LetsEncrypt-SSL","category":"Web勉強","tags":["ConoHa","Let’s Encrypt","SSL"],"description":"Let’s EncryptでSSL設定"},"markdownBody":"\n[これ](/posts/ConoHaでサブドメインを使う)で書いたApacheをLet’s Encryptを使用してSSLに対応させた。\n\n## 必要なツールのダウンロード\n今回は「[cerbot](https://github.com/certbot/certbot.git)」を使用するのでgitを使用してダンロードする。\n```bash\ngit clone https://github.com/certbot/certbot.git\n```\n\n## ファイアウォールの設定\n現状はhttpsでのアクセスができなくなっているのでアクセスできるように設定する。\n\n```bash\nsudo firewall-cmd --add-service=https --zone=public --permanent\nsudo firewall-cmd --reload\n```\n\n## SSLの設定\n最初にダウロードしたcerbotを使用して設定する。\n```bash\n./certbot-auto certonly --non-interactive --agree-tos --webroot -w [ドキュメントルート] -d [ドメイン] --email [メールアドレス]\n```\n\n## Apacheで証明書の設定\n```bash\nvim /etc/httpd/conf.d/ssl.conf\n```\n下記の2行部分を修正した。\n```text\nSSLCertificateFile /etc/letsencrypt/live/[ドメイン]/cert.pem\nSSLCertificateKeyFile /etc/letsencrypt/live/[ドメイン]/privkey.pem\n```\n\n## HTTPからHTTPSへのリダイレクト設定\n```text\n<IfModule rewrite_module>\n    RewriteEngine On\n    LogLevel alert rewrite:trace3\n    RewriteCond %{HTTPS} off\n    RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R,L]\n</IfModule>\n```\n\n## Apacheの再起動\n最後にApacheを再起動したら完了\n```bash\nsudo service httpd restart\n```\n"},"__N_SSG":true}